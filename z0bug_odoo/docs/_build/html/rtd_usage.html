<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Usage &#8212; z0bug_odoo 2.0.22 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=279e0f84" />
    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=7318b3e0"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting started" href="rtd_getting_started.html" />
    <link rel="prev" title="Features" href="rtd_features.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rtd_getting_started.html" title="Getting started"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rtd_features.html" title="Features"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">z0bug_odoo 2.0.22 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Usage</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Link to this heading">ÔÉÅ</a></h1>
<section id="usage-details">
<h2>Usage Details<a class="headerlink" href="#usage-details" title="Link to this heading">ÔÉÅ</a></h2>
<p>You can locate the recent testenv.py in testenv directory of module
<a class="reference external" href="https://github.com/zeroincombenze/tools/tree/master/z0bug_odoo/testenv">z0bug_odoo</a></p>
<p>For full documentation visit:
<a class="reference external" href="https://zeroincombenze-tools.readthedocs.io/en/latest/pypi_z0bug_odoo/index.html">zero-tools</a>
or
<a class="reference external" href="https://z0bug-odoo.readthedocs.io/en/latest/">z0bug_odoo</a>
or
<a class="reference external" href="https://github.com/zeroincombenze/tools">zero-tools (github)</a>
or
<a class="reference external" href="https://github.com/zeroincombenze/zerobug-test">github with example modules</a></p>
<p>Copy the testenv.py file in tests directory of your module.
Please copy the documentation testenv.rst file in your module too.</p>
<p>The __init__.py must import testenv.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">testenv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">test_</span><span class="o">&lt;</span><span class="n">MY_TEST_FILE</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Your python test file have to contain some following example lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.testenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">MainTest</span> <span class="k">as</span> <span class="n">SingleTransactionCase</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">TEST_SETUP_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;res.partner&quot;</span><span class="p">,</span> <span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyTest</span><span class="p">(</span><span class="n">SingleTransactionCase</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="c1"># Add following statement just for get debug information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_level</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="c1"># keep data after tests</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odoo_commit_data</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_env</span><span class="p">()</span>                <span class="c1"># Create test environment</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">tearDown</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_mytest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;üé∫ Testing test_mytest&quot;</span>    <span class="c1"># Use unicode char to best log reading</span>
        <span class="p">)</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>An important helper to debug is self.debug_level. When you begins your test cycle,
you are hinted to set self.debug_level = 3; then you can decrease the debug level
when you are developing stable tests.
Final code should have self.debug_level = 0.
TestEnv logs debug message with symbol ‚Äúüêû ‚Äú so you can easily recognize them.
Another useful helper is the database keep data after test feature. You have to declare
self.odoo_commit_data = True and you have to set global bash environment</p>
<p><code class="docutils literal notranslate"><span class="pre">global</span> <span class="pre">ODOO_COMMIT_DATA=&quot;1&quot;</span></code></p>
<p>Ths TestEnv software requires:</p>
<ul class="simple">
<li><p>python_plus PYPI package</p></li>
<li><p>z0bug_odoo PYPI package version 2.0.22</p></li>
<li><p>python 2.7 / 3.6 / 3.7 / 3.8 / 3.9 / 3.10</p></li>
</ul>
<section id="model-data-declaration">
<h3>Model data declaration<a class="headerlink" href="#model-data-declaration" title="Link to this heading">ÔÉÅ</a></h3>
<p>Each model is declared in a csv file or xlsx file in <strong>test/data</strong> directory of the
module. The file name is the same of model name with dots replaced by undescore.</p>
<p>i.e. below the contents of <strong>res_parter.csv</strong> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">street</span>
<span class="n">z0bug</span><span class="o">.</span><span class="n">partner1</span><span class="p">,</span><span class="n">Alpha</span><span class="p">,</span><span class="s2">&quot;1, First Avenue&quot;</span>
</pre></div>
</div>
<p>The model may also be declared in a dictionary which key which is the external
reference used to retrieve the record.</p>
<p>i.e. the following record declaration is the same of above example; record id is named
<code class="docutils literal notranslate"><span class="pre">z0bug.partner1</span></code> in res.partner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_RES_PARTNER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alpha&quot;</span><span class="p">,</span>
        <span class="s2">&quot;street&quot;</span><span class="p">:</span> <span class="s2">&quot;1, First Avenue&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please, do not to declare <code class="docutils literal notranslate"><span class="pre">product.product</span></code> records: they are automatically
created as child of <code class="docutils literal notranslate"><span class="pre">product.template</span></code>. The external reference must contain
the pattern <code class="docutils literal notranslate"><span class="pre">_template</span></code> (see below).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you write a file with a spreadsheet app, pay attention to automatic string
replacement. For example double quote char &lt;‚Äù&gt; may be replaced by &lt;‚Äù&gt;.
These replaced characters may be create some troubles during import data step,
expecially when used in ‚Äúpython expression‚Äù.</p>
</div>
</section>
<section id="magic-relationship">
<h3>Magic relationship<a class="headerlink" href="#magic-relationship" title="Link to this heading">ÔÉÅ</a></h3>
<p>Some models/tables should be managed together, i.e. <strong>account.move</strong> and <strong>account.move.line</strong>.
TestEnv manages these models/tables, called header/detail, just as a single object.
When header record is created, all detail lines are created with header.
Odoo standard declaration requires the details data in child reference field with
command <em>0, 0</em>.
This method make unreadable the source data. Look at the simple follow example with
usually Odoo declaration way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sale_order_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;example.order_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;partner_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="s2">&quot;base.res_partner_1&quot;</span><span class="p">),</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span>
        <span class="o">...</span>
        <span class="s2">&quot;order_line&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span>
                <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="s2">&quot;product.product_product_1&quot;</span><span class="p">),</span>
                <span class="s2">&quot;product_qty&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;price_unit&quot;</span><span class="p">:</span> <span class="mf">1.23</span><span class="p">,}),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span>
                <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="s2">&quot;product.product_product_2&quot;</span><span class="p">),</span>
                <span class="s2">&quot;product_qty&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;price_unit&quot;</span><span class="p">:</span> <span class="mf">2.34</span><span class="p">,}),</span>
        <span class="p">]</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Now look at the same data in internal declaration by <strong>z0bug_odoo</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_SALE_ORDER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;example.order_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;partner_id&quot;</span><span class="p">:</span> <span class="s2">&quot;base.res_partner_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="n">TEST_SALE_ORDER_LINE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;example.order_1_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;product.product_product_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_qty&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;price_unit&quot;</span><span class="p">:</span> <span class="mf">1.23</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;example.order_1_2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;product.product_product_2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_qty&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;price_unit&quot;</span><span class="p">:</span> <span class="mf">2.34</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you can see, the data is easy readable and easy updatable. Please, notice:</p>
<ol class="arabic simple">
<li><p>Sale order lines are declared in specific model <strong>sale.order.line</strong></p></li>
<li><p>Record ID <strong>must</strong> begin with header ID, followed by ‚Äú_‚Äù and line ID</p></li>
<li><p>Reference data do not require <code class="docutils literal notranslate"><span class="pre">self.env.ref()</span></code>: they are automatically referenced</p></li>
</ol>
<p>It is also easy write the csv or xlsx file. This is the example with above data</p>
<p>File <strong>sale_order.csv</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="p">,</span><span class="n">partner_id</span><span class="p">,</span><span class="n">origin</span>
<span class="n">example</span><span class="o">.</span><span class="n">order_1</span><span class="p">,</span><span class="n">base</span><span class="o">.</span><span class="n">res_partner_1</span><span class="p">,</span><span class="n">example</span>
</pre></div>
</div>
<p>File <strong>sale_order_line.csv</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="p">,</span><span class="n">product_id</span><span class="p">,</span><span class="n">product_qty</span><span class="p">,</span><span class="n">price_unit</span>
<span class="n">example</span><span class="o">.</span><span class="n">order_1_1</span><span class="p">,</span><span class="n">product</span><span class="o">.</span><span class="n">product_product_1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.23</span>
<span class="n">example</span><span class="o">.</span><span class="n">order_1_2</span><span class="p">,</span><span class="n">product</span><span class="o">.</span><span class="n">product_product_2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.34</span>
</pre></div>
</div>
<p>In your test file you must declare the following statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_SETUP_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sale.order&quot;</span><span class="p">,</span> <span class="s2">&quot;sale.order.line&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You must declare header and lines data before create header record</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External reference coding is free: however is hinted to use the The 2
keys reference explained in ‚ÄúExternal reference‚Äù chapter.</p>
</div>
<p>Another magic relationship is the <strong>product.template</strong> (product) / <strong>product.product</strong> (variant)
relationship.
Whenever a <strong>product.template</strong> (product) record is created,
Odoo automatically creates one variant (child) record for <strong>product.product</strong>.
If your test module does not need to manage product variants you can avoid to declare
<strong>product.product</strong> data even if this model is used in your test data.</p>
<p>For example, you have to test <strong>sale.order.line</strong> which refers to <strong>product.product</strong>.
You simply declare a <strong>product.template</strong> record with external reference
uses ‚Äú_template‚Äù magic text.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_PRODUCT_TEMPLATE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.product_template_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Product alpha&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="o">...</span>

<span class="n">TEST_SALE_ORDER_LINE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.order_1_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;z0bug.product_product_1&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="external-reference">
<h3>External reference<a class="headerlink" href="#external-reference" title="Link to this heading">ÔÉÅ</a></h3>
<p>Every record tagged by an external reference may be:</p>
<blockquote>
<div><ul class="simple">
<li><p>Ordinary Odoo external reference <code class="docutils literal notranslate"><span class="pre">(a)</span></code>, format ‚Äúmodule.name‚Äù</p></li>
<li><p>Test reference, format ‚Äúz0bug.name‚Äù <code class="docutils literal notranslate"><span class="pre">(b)</span></code></p></li>
<li><p>Key value, format ‚Äúexternal.key‚Äù <code class="docutils literal notranslate"><span class="pre">(c)</span></code></p></li>
<li><p>2 keys reference, for header/detail relationship <code class="docutils literal notranslate"><span class="pre">(d)</span></code></p></li>
<li><p>Magic reference for <strong>product.template</strong> / <strong>product.product</strong> <code class="docutils literal notranslate"><span class="pre">(e)</span></code></p></li>
</ul>
</div></blockquote>
<p>Ordinary Odoo external reference <code class="docutils literal notranslate"><span class="pre">(a)</span></code> is a record of <strong>ir.model.data</strong>;
you can see them from Odoo GUI interface.</p>
<p>Test reference <code class="docutils literal notranslate"><span class="pre">(b)</span></code> are visible just in the test environment.
They are identified by ‚Äúz0bug.‚Äù prefix module name.</p>
<p>External key reference <code class="docutils literal notranslate"><span class="pre">(c)</span></code> is identified by ‚Äúexternal.‚Äù prefix followed by
the key value used to retrieve the record.
If key value is an integer it is the record ‚Äúid‚Äù.
The field ‚Äúcode‚Äù or ‚Äúname‚Äù are used to search record;
for account.tax the ‚Äúdescription‚Äù field is used.
Please set self.debug_level = 2 (or more) to log these field keys.</p>
<p>The 2 keys reference <code class="docutils literal notranslate"><span class="pre">(d)</span></code> needs to address child record inside header record
at 2 level model (header/detail) relationship.
The key MUST BE the same key of the parent record,
plus ‚Äú_‚Äù, plus line identifier (usually <strong>sequence</strong> field).
i.e. <code class="docutils literal notranslate"><span class="pre">z0bug.move_1_3</span></code> means: line with sequence <code class="docutils literal notranslate"><span class="pre">3</span></code> of <strong>account.move.line</strong>
which is child of record <code class="docutils literal notranslate"><span class="pre">z0bug.move_1</span></code> of <strong>account.move</strong>.
Please set self.debug_level = 2 (or more) to log these relationships.</p>
<p>For <strong>product.template</strong> (product) you must use ‚Äò_template‚Äô text in reference <code class="docutils literal notranslate"><span class="pre">(e)</span></code>.
TestEnv inherit <strong>product.product</strong> (variant) external reference
(read above ‚ÄúMagic relationship‚Äù).</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_ACCOUNT_ACCOUNT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.customer_account&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">...</span>
    <span class="p">}</span>
    <span class="s2">&quot;z0bug.supplier_account&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;111100&quot;</span><span class="p">,</span> <span class="o">...</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="o">...</span>

<span class="bp">self</span><span class="o">.</span><span class="n">resource_edit</span><span class="p">(</span>
    <span class="n">partner</span><span class="p">,</span>
    <span class="n">web_changes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;country_id&quot;</span><span class="p">,</span> <span class="s2">&quot;base.it&quot;</span><span class="p">),</span>       <span class="c1"># Odoo external reference (type a)</span>
        <span class="p">(</span><span class="s2">&quot;property_account_receivable_id&quot;</span><span class="p">,</span>
         <span class="s2">&quot;z0bug.customer_account&quot;</span><span class="p">),</span>      <span class="c1"># Test reference (type b)</span>
        <span class="p">(</span><span class="s2">&quot;property_account_payable_id&quot;</span><span class="p">,</span>
         <span class="s2">&quot;external.111100&quot;</span><span class="p">),</span>             <span class="c1"># External key (type c)</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="module-test-execution-session">
<h2>Module test execution session<a class="headerlink" href="#module-test-execution-session" title="Link to this heading">ÔÉÅ</a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">ÔÉÅ</a></h3>
<p>Module test execution workflow should be:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Data declaration, in file .csv or .xlsz√¨x or in source code</p></li>
<li><p>Base data creation, in setUp() function</p></li>
<li><p>Tests execution</p></li>
<li><p>Supplemental data creation, during test execution, by group name</p></li>
</ol>
</div></blockquote>
<p>Test data may be managed by one or more data group; if not declared,
‚Äúbase‚Äù group name is used. The ‚Äúbase‚Äù group will be created at the setUp()
level: it is the base test data.
Testing function may declare and manage other group data. Look at the
following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.testenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">MainTest</span> <span class="k">as</span> <span class="n">SingleTransactionCase</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">TEST_PRODUCT_TEMPLATE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.product_template_1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">TEST_RES_PARTNER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">TEST_SETUP_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;res.partner&quot;</span><span class="p">,</span> <span class="s2">&quot;product.template&quot;</span><span class="p">]</span>

<span class="n">TEST_SALE_ORDER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.order_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;partner_id&quot;</span><span class="p">:</span> <span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">TEST_SALE_ORDER_LINE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z0bug.order_1_1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;z0bug.product_product_1&quot;</span><span class="p">,</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyTest</span><span class="p">(</span><span class="n">SingleTransactionCase</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_level</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_env</span><span class="p">()</span>                <span class="c1"># Create base test environment</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Now add Sale Order data, group &quot;order&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_env</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="n">setup_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sale.order&quot;</span><span class="p">,</span> <span class="s2">&quot;sale.order.line&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Note the external reference are globals and they are visible from any groups.
After base data is created, the real test session can begin. You can simulate
various situation; the most common are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Simulate web form create record</p></li>
<li><p>Simulate web form update record</p></li>
<li><p>Simulate the multi-record windows action</p></li>
<li><p>Download any binary data created by test</p></li>
<li><p>Engage wizard</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also create / update record with usually create() / write() Odoo function,
but they do not really simulate the user behavior because they do not engage the
onchange methods, they do not load any view and so on.</p>
</div>
<p>The real best way to test a create record is like the follow example
based on <strong>res.partner model</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">partner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_edit</span><span class="p">(</span>
    <span class="n">resource</span><span class="o">=</span><span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">web_changes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Adam&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;country_id&quot;</span><span class="p">,</span> <span class="s2">&quot;base.us&quot;</span><span class="p">),</span>
        <span class="o">...</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can also simulate the update session, issuing the record:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">partner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_edit</span><span class="p">(</span>
    <span class="n">resource</span><span class="o">=</span><span class="n">partner</span><span class="p">,</span>
    <span class="n">web_changes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Adam Prime&quot;</span><span class="p">),</span>
        <span class="o">...</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Look at resource_edit() documentation for furthermore details.</p>
<p>In you test session you should need to test a wizard. This test is very easy
to execute as in the follow example that engage the standard language install
wizard:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We engage language translation wizard with &quot;it_IT&quot; language</span>
<span class="c1"># see &quot;&lt;ODOO_PATH&gt;/addons/base/module/wizard/base_language_install*&quot;</span>
<span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;üé∫ Testing wizard.lang_install()&quot;</span><span class="p">)</span>
<span class="n">act_windows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wizard</span><span class="p">(</span>
    <span class="n">module</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">,</span>
    <span class="n">action_name</span><span class="o">=</span><span class="s2">&quot;action_view_base_language_install&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lang&quot;</span><span class="p">:</span> <span class="s2">&quot;it_IT&quot;</span>
        <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">button_name</span><span class="o">=</span><span class="s2">&quot;lang_install&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_action</span><span class="p">(</span><span class="n">act_windows</span><span class="p">),</span>
    <span class="s2">&quot;No action returned by language install&quot;</span>
<span class="p">)</span>
<span class="c1"># Now we test the close message</span>
<span class="bp">self</span><span class="o">.</span><span class="n">wizard</span><span class="p">(</span>
    <span class="n">act_windows</span><span class="o">=</span><span class="n">act_windows</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;res.lang&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">search</span><span class="p">([(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;it_IT&quot;</span><span class="p">)]),</span>
    <span class="s2">&quot;No language </span><span class="si">%s</span><span class="s2"> loaded!&quot;</span> <span class="o">%</span> <span class="s2">&quot;it_IT&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Look at wizard() documentation for furthermore details.</p>
</section>
</section>
<section id="data-values">
<h2>Data values<a class="headerlink" href="#data-values" title="Link to this heading">ÔÉÅ</a></h2>
<p>Data values may be raw data (string, number, dates, etc.) or external reference
or some macro.
You can declare data value on your own but you can discover the full test environment
in <a class="reference external" href="https://github.com/zeroincombenze/zerobug-test/mk_test_env/">https://github.com/zeroincombenze/zerobug-test/mk_test_env/</a> and get data
from this environment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The fields <strong>company_id</strong> and <strong>currency_id</strong> may be empty to use default value.
If you want to issue no value, do not declare column in model file (csv or xlsx).</p>
</div>
<p>You can evaluate the field value engaging a simple python expression inside tags like in
following syntax:</p>
<blockquote>
<div><p>‚Äú&lt;?odoo EXPRESSION ?&gt;‚Äù</p>
</div></blockquote>
<p>The expression may be a simple python expression with following functions:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>function</p></td>
<td><p>description</p></td>
<td><p>example</p></td>
</tr>
<tr class="row-even"><td><p>compute_date</p></td>
<td><p>Compute date</p></td>
<td><p>&lt;?odoo compute_date(‚Äò&lt;###-##-##‚Äô)[0:4] ?&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>random</p></td>
<td><p>Generate random number from 0.0 to 1.0</p></td>
<td><p>&lt;?odoo int(random() * 1000) ?&gt;</p></td>
</tr>
<tr class="row-even"><td><p>ref</p></td>
<td><p>Odoo reference self.env.ref()</p></td>
<td><p>&lt;?odoo ref(‚Äòproduct.product_product_1‚Äô) ?&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>ref[field]</p></td>
<td><p>field of record of external reference</p></td>
<td><p>&lt;?odoo ref(‚Äòproduct.product_product_1‚Äô).name ?&gt;</p></td>
</tr>
<tr class="row-even"><td><p>ref[field]</p></td>
<td><p>field of record of external reference (brief)</p></td>
<td><p>&lt;?odoo product.product_product_1.name ?&gt;</p></td>
</tr>
</tbody>
</table>
<section id="company-id">
<h3>company_id<a class="headerlink" href="#company-id" title="Link to this heading">ÔÉÅ</a></h3>
<p>If value is empty, user company is used.
This behavior is not applied on
<strong>res.users</strong>, <strong>res.partner</strong>, <strong>product.template</strong> and <strong>product.product</strong> models.
For these models you must fill the <strong>company_id</strong> field.</p>
<p>When data is searched by <code class="docutils literal notranslate"><span class="pre">resource_search()</span></code> function on every model with company_id,
the <strong>company_id</strong> field is automatically added to search domain, using ‚Äòor‚Äô between
company_id null and company_id equal to supplied value or current user company.</p>
</section>
<section id="boolean">
<h3>boolean<a class="headerlink" href="#boolean" title="Link to this heading">ÔÉÅ</a></h3>
<p>You can declare boolean value:</p>
<ul class="simple">
<li><p>by python boolean False or True</p></li>
<li><p>by integer 0 or 1</p></li>
<li><p>by string ‚Äú0‚Äù or ‚ÄúFalse‚Äù or ‚Äú1‚Äù or ‚ÄúTrue‚Äù</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;supplier&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;customer&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_company&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="char-text">
<h3>char / text<a class="headerlink" href="#char-text" title="Link to this heading">ÔÉÅ</a></h3>
<p>Char and Text values are python string; please use unicode whenever is possible
even when you test Odoo 10.0 or less.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alpha&quot;</span><span class="p">,</span>
            <span class="s2">&quot;street&quot;</span><span class="p">:</span> <span class="s2">&quot;1, First Avenue&quot;</span>
            <span class="c1"># Name of Caserta city</span>
            <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;? base.state_it_ce.name ?&gt;&quot;</span><span class="p">,</span>
            <span class="c1"># Reference: &#39;year/123&#39;</span>
            <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;? compute_date(&#39;####-##-##&#39;)[0:4] + &#39;/123&#39; ?&gt;&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="integer-float-monetary">
<h3>integer / float / monetary<a class="headerlink" href="#integer-float-monetary" title="Link to this heading">ÔÉÅ</a></h3>
<p>Integer, Floating and Monetary values are python integer or float.
If numeric value is issued as string, it is internally converted
as integer/float.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;credit_limit&quot;</span><span class="p">:</span> <span class="mf">500.0</span><span class="p">,</span>
            <span class="s2">&quot;payment_token_count&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="date-datetime">
<h3>date / datetime<a class="headerlink" href="#date-datetime" title="Link to this heading">ÔÉÅ</a></h3>
<p>Date and Datetime value are managed in special way.
They are processed by <code class="docutils literal notranslate"><span class="pre">compute_date()</span></code> function (read below).
You can issue a single value or a 2 values list, 1st is the date,
2nd is the reference date.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;activity_date_deadline&quot;</span><span class="p">:</span> <span class="s2">&quot;####-1&gt;-##&quot;</span><span class="p">,</span>    <span class="c1"># Next month</span>
            <span class="s2">&quot;signup_expiration&quot;</span><span class="p">:</span> <span class="s2">&quot;###&gt;-##-##&quot;</span><span class="p">,</span>         <span class="c1"># Next year</span>
            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>                                <span class="c1"># Yesterday</span>
            <span class="s2">&quot;last_time_entries_checked&quot;</span><span class="p">:</span>
                <span class="p">[</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">another_date</span><span class="p">],</span>                    <span class="c1"># 2 days after another day</span>
            <span class="s2">&quot;message_last_post&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-06-26&quot;</span><span class="p">,</span>         <span class="c1"># Specific date, ISO format</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="many2one">
<h3>many2one<a class="headerlink" href="#many2one" title="Link to this heading">ÔÉÅ</a></h3>
<p>You can issue an integer (if you know exactly the ID)
or an external reference. Read above about external reference.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;country_id&quot;</span><span class="p">:</span> <span class="s2">&quot;base.it&quot;</span><span class="p">,</span>                   <span class="c1"># Odoo external reference</span>
            <span class="s2">&quot;property_account_payable_id&quot;</span><span class="p">:</span>
                <span class="s2">&quot;z0bug.customer_account&quot;</span><span class="p">,</span>              <span class="c1"># Test record</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;external.Mister&quot;</span>                 <span class="c1"># Record with name==&quot;Mister&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="one2many-many2many">
<h3>one2many / many2many<a class="headerlink" href="#one2many-many2many" title="Link to this heading">ÔÉÅ</a></h3>
<p>The one2many and many2many field may contains one or more ID;
every ID use the same above many2one notation with external reference.
Value may be a string (just 1 value) or a list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;bank_ids&quot;</span><span class="p">:</span>
                <span class="p">[</span>
                    <span class="s2">&quot;base.bank_partner_demo&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;base_iban.bank_iban_china_export&quot;</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="s2">&quot;category_id&quot;</span><span class="p">:</span> <span class="s2">&quot;base.res_partner_category_0&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also use tha classic Odoo syntax with commands:
You can integrate classic Odoo syntax with <strong>z0bug_odoo external</strong> reference.</p>
</div>
<ul class="simple">
<li><p>[0, 0, values (dict)]               # CREATE record and link</p></li>
<li><p>[1, ID (int), values (dict)]        # UPDATE linked record</p></li>
<li><p>[2, ID (int)]                       # DELETE linked record by ID</p></li>
<li><p>[3, ID (int)]                       # UNLINK record ID (do not delete record)</p></li>
<li><p>[4, ID (int)]                       # LINK record by ID</p></li>
<li><p>[5, x] or [5]                       # CLEAR unlink all record IDs</p></li>
<li><p>[6, x, IDs (list)]                  # SET link record IDs</p></li>
</ul>
</section>
<section id="binary">
<h3>binary<a class="headerlink" href="#binary" title="Link to this heading">ÔÉÅ</a></h3>
<p>Binary file are supplied with os file name. Test environment load file and
get binary value. File must be located in <strong>tests/data</strong> directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">resource_create</span><span class="p">(</span>
    <span class="s2">&quot;res.partner&quot;</span><span class="p">,</span>
    <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;z0bug.partner1&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="p">{</span>
         <span class="p">{</span>
            <span class="o">...</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;z0bug.partner1.png&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="useful-external-reference">
<h2>Useful External Reference<a class="headerlink" href="#useful-external-reference" title="Link to this heading">ÔÉÅ</a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>id</p></td>
<td><p>name</p></td>
<td><p>model</p></td>
<td><p>note</p></td>
</tr>
<tr class="row-even"><td><p>z0bug.coa_bank</p></td>
<td><p>Bank</p></td>
<td><p>account.account</p></td>
<td><p>Default bank account</p></td>
</tr>
<tr class="row-odd"><td><p>external.INV</p></td>
<td><p>Sale journal</p></td>
<td><p>account.journal</p></td>
<td><p>Default sale journal</p></td>
</tr>
<tr class="row-even"><td><p>external.BILL</p></td>
<td><p>Purchase journal</p></td>
<td><p>account.journal</p></td>
<td><p>Default purchase journal</p></td>
</tr>
<tr class="row-odd"><td><p>external.MISC</p></td>
<td><p>Miscellaneous journal</p></td>
<td><p>account.journal</p></td>
<td><p>Default miscellaneous journal</p></td>
</tr>
<tr class="row-even"><td><p>external.BNK1</p></td>
<td><p>Bank journal</p></td>
<td><p>account.journal</p></td>
<td><p>Default bank journal</p></td>
</tr>
<tr class="row-odd"><td><p>account.account_payment_term_immediate</p></td>
<td><p>Immediate Payment</p></td>
<td><p>account.payment.term</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>account.account_payment_term_net</p></td>
<td><p>30 Net Days</p></td>
<td><p>account.payment.term</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>z0bug.tax_22a</p></td>
<td><p>Purchase 22% VAT</p></td>
<td><p>account.tax</p></td>
<td><p>Italian default purchase VAT rate</p></td>
</tr>
<tr class="row-even"><td><p>z0bug.tax_22v</p></td>
<td><p>Sale 22% VAT</p></td>
<td><p>account.tax</p></td>
<td><p>Italian default sale VAT rate</p></td>
</tr>
<tr class="row-odd"><td><p>base.main_company</p></td>
<td><p>Default company</p></td>
<td><p>res.company</p></td>
<td><p>Default company for test</p></td>
</tr>
<tr class="row-even"><td><p>product.product_category_1</p></td>
<td><p>All / Saleable</p></td>
<td><p>product.category</p></td>
<td><p>Useful product category</p></td>
</tr>
<tr class="row-odd"><td><p>base.USD</p></td>
<td><p>USD currency</p></td>
<td><p>res.currency</p></td>
<td><p>Test currency during test execution: US dollar</p></td>
</tr>
<tr class="row-even"><td><p>base.user_root</p></td>
<td><p>Administrator</p></td>
<td><p>res.users</p></td>
<td><p>User under test execution</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">ÔÉÅ</a></h2>
<section id="cast-types">
<h3>cast_types<a class="headerlink" href="#cast-types" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>cast_types(self, resource, values, fmt=None, group=None, not_null=False)</strong></p>
<p>Convert resource fields in appropriate type, based on Odoo type.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">resource (str): Odoo model name</div>
<div class="line">values (dict): record data</div>
<div class="line">fmt (selection): output format</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">Appropriate values</div>
</div>
</div>
<p>The parameter fmt declares the purpose of casting and declare the returned format of
&lt;2many&gt; fields as follows table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                <span class="o">|</span> <span class="n">fmt</span><span class="o">==</span><span class="s1">&#39;cmd&#39;</span>         <span class="o">|</span> <span class="n">fmt</span><span class="o">==</span><span class="s1">&#39;id&#39;</span>  <span class="o">|</span> <span class="n">fmt</span><span class="o">==</span><span class="s1">&#39;py&#39;</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="nb">dict</span><span class="p">)]</span>          <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="nb">dict</span><span class="p">)]</span> <span class="o">*</span>   <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">*</span>   <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">*</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">xref</span><span class="p">)]</span>          <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="o">|</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="nb">dict</span><span class="p">)]</span>     <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>     <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">2</span><span class="o">|</span><span class="mi">3</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="mi">5</span><span class="p">,</span><span class="nb">id</span><span class="p">)]</span>          <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>              <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>      <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">2</span><span class="o">|</span><span class="mi">3</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="mi">5</span><span class="p">,</span><span class="n">xref</span><span class="p">)]</span>        <span class="o">|</span> <span class="p">[(</span><span class="mi">2</span><span class="o">|</span><span class="mi">3</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="mi">5</span><span class="p">,</span><span class="nb">id</span><span class="p">)]</span>     <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>      <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">ids</span><span class="p">])]</span>           <span class="o">|</span> <span class="k">as</span> <span class="ow">is</span>              <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">xref</span><span class="p">)]</span>            <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="nb">id</span><span class="p">])]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">xref</span><span class="p">,</span><span class="o">...</span><span class="p">])]</span>      <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">ids</span><span class="p">])]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="nb">dict</span>                    <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">dict</span><span class="p">)</span>        <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>     <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="n">xref</span> <span class="p">(</span><span class="n">exists</span><span class="p">)</span>           <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="nb">id</span><span class="p">])]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="n">xref</span> <span class="p">(</span><span class="ow">not</span> <span class="n">exists</span><span class="p">)</span>       <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">dict</span><span class="p">)]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>     <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">xref</span><span class="p">]</span> <span class="p">(</span><span class="n">exists</span><span class="p">)</span>         <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="nb">id</span><span class="p">])]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">xref</span><span class="p">]</span> <span class="p">(</span><span class="ow">not</span> <span class="n">exists</span><span class="p">)</span>     <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">dict</span><span class="p">)]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>     <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">xref</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="p">(</span><span class="n">exists</span><span class="p">)</span>     <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">ids</span><span class="p">])]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">xref</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="p">(</span><span class="ow">not</span> <span class="n">exists</span><span class="p">)</span> <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">dict</span><span class="p">),(</span><span class="o">...</span><span class="p">)]</span> <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">,</span><span class="o">...</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span> <span class="o">**</span>                <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">ids</span><span class="p">])]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="nb">id</span>                      <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="nb">id</span><span class="p">])]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>       <span class="o">|</span> <span class="p">[</span><span class="nb">id</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="s2">&quot;xref,...&quot;</span> <span class="p">(</span><span class="n">exists</span><span class="p">)</span>     <span class="o">|</span> <span class="p">[(</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="n">ids</span><span class="p">])]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>      <span class="o">|</span> <span class="p">[</span><span class="n">ids</span><span class="p">]</span>
<span class="o">&lt;</span><span class="mi">2</span><span class="n">many</span><span class="o">&gt;</span> <span class="s2">&quot;xref,...&quot;</span> <span class="p">(</span><span class="ow">not</span> <span class="n">exists</span><span class="p">)</span> <span class="o">|</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">dict</span><span class="p">),(</span><span class="o">...</span><span class="p">)]</span> <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="p">[</span><span class="nb">dict</span><span class="p">,</span><span class="o">...</span><span class="p">]</span>

<span class="n">Caption</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">..</span><span class="p">},</span> <span class="n">xref</span> <span class="o">-&gt;</span> <span class="s2">&quot;abc.def&quot;</span><span class="p">,</span> <span class="nb">id</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ids</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">...</span>
<span class="o">*</span> <span class="n">fields</span> <span class="n">of</span> <span class="nb">dict</span> <span class="n">are</span> <span class="n">recursively</span> <span class="n">processed</span>
<span class="o">**</span> <span class="n">ids</span> <span class="mi">1</span><span class="o">-</span><span class="mi">6</span> <span class="n">have</span> <span class="n">processed</span> <span class="k">as</span> <span class="n">Odoo</span> <span class="n">cmd</span>
</pre></div>
</div>
<p>fmt ==  ‚Äòcmd‚Äô means convert to Odoo API format: &lt;2many&gt; fields are returned with
prefixed 0|1|2|3|4|5|6 value (read _cast_2many docs).</p>
<p>fmt == ‚Äòid‚Äô is like ‚Äòcmd‚Äô: prefix are added inside dict not at the beginning.</p>
<p>fmt == ‚Äòpy‚Äô means convert to native python (remove all Odoo command prefixes).
It is used for comparison.</p>
<p>When no format is required (fmt is None), some conversion may be not applicable:</p>
<p>&lt;many2one&gt; field will be left unchanged when invalid xref is issued and &lt;2many&gt;
field me will be left unchanged when one or more invalid xref are issued.</p>
<p>str, int, long, selection, binary, html fields are always left as is</p>
<p>date, datetime fields and fmt==‚Äôcmd‚Äô and python2 (odoo &lt;= 10.0) return ISO format
many2one fields, if value is (int|long) are left as is; if value is (xref) the
id of xref is returned.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Odoo one2many valid cmd are: 0,1 and 2 (not checked)</p>
</div>
</section>
<section id="store-resource-data">
<h3>store_resource_data<a class="headerlink" href="#store-resource-data" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>store_resource_data(self, resource, xref, values, group=None, name=None)</strong></p>
<p>Store a record data definition for furthermore use.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">resource (str): Odoo model name</div>
<div class="line">xref (str): external reference</div>
<div class="line">values (dict): record data</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line">name (str): label of dataset; default is resource name</div>
</div>
</div>
<p>Data stored is used by <code class="docutils literal notranslate"><span class="pre">setup_env()</span></code> function and/or by:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">resource_create()</span></code> without values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_write()</span></code> without values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resource_make()</span></code> without values</p></li>
</ul>
</section>
<section id="compute-date">
<h3>compute_date<a class="headerlink" href="#compute-date" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>compute_date(self, date, refdate=None)</strong></p>
<p>Compute date or datetime against today or a reference date.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">date (date or string or integer): text date formula</div>
<div class="line">refdate (date or string): reference date</div>
</div>
</div>
<p>Date may be:</p>
<ul class="simple">
<li><p>python date/datetime value</p></li>
<li><p>string with ISO format ‚ÄúYYYY-MM-DD‚Äù or ‚ÄúYYYY-MM-DD HH:MM:SS‚Äù</p></li>
<li><p>string value that is a relative date against today or reference date</p></li>
</ul>
<p>Relative string format is like ISO, with 3 groups separated by ‚Äò-‚Äô (dash).
Every group may be an integer or a special notation:</p>
<ul class="simple">
<li><p>starting with ‚Äò&lt;‚Äô meas subtract; i.e. ‚Äò&lt;2‚Äô means minus 2</p></li>
<li><p>ending with ‚Äò&gt;‚Äô meas add; i.e. ‚Äò2&gt;‚Äô means plus 2</p></li>
<li><p>‚Äò#‚Äô with ‚Äò&lt;‚Äô or ‚Äò&gt;‚Äô means 1; i.e. ‚Äò&lt;###‚Äô means minus 1</p></li>
<li><p>all ‚Äò#‚Äô means same value of reference date</p></li>
</ul>
<p>A special notation ‚Äò+N‚Äô and ‚Äò-N‚Äô, where N is an integer means add N days
or subtract N day from reference date.
Here, in following examples, are used python iso date convention:</p>
<ul class="simple">
<li><p>‚Äò+N‚Äô: return date + N days to refdate (python timedelta)</p></li>
<li><p>‚Äò-N‚Äô: return date - N days from refdate (python timedelta)</p></li>
<li><p>‚Äò%Y-%m-%d‚Äô: strftime of issued value</p></li>
<li><p>‚Äò%Y-%m-%dT%H:%M:%S‚Äô: same datetime</p></li>
<li><p>‚Äò%Y-%m-%d %H:%M:%S‚Äô: same datetime</p></li>
<li><p>‚Äò####-%m-%d‚Äô: year from refdate (or today), month ‚Äò%m‚Äô, day ‚Äò%d‚Äô</p></li>
<li><p>‚Äò####-##-%d‚Äô: year and month from refdate (or today), day ‚Äò%d‚Äô</p></li>
<li><p>‚Äò2024-##-##‚Äô: year 2024, month and day from refdate (or today)</p></li>
<li><p>‚Äò&lt;###-%m-%d‚Äô: year -1  from refdate (or today), month ‚Äò%m‚Äô, day ‚Äò%d‚Äô</p></li>
<li><p>‚Äò&lt;001-%m-%d‚Äô: year -1  from refdate (or today), month ‚Äò%m‚Äô, day ‚Äò%d‚Äô</p></li>
<li><p>‚Äò&lt;###-#&gt;-%d‚Äô: year -1  from refdate, month +1 from refdate, day ‚Äò%d‚Äô</p></li>
<li><p>‚Äò&lt;005-2&gt;-##‚Äô: year -5, month +2 and day from refdate</p></li>
</ul>
<dl class="simple">
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Returns a ISO format string.</p></li>
<li><p>Returned date is a valid date; i.e. ‚Äò####-#&gt;-31‚Äô, with ref month January result ‚Äò####-02-31‚Äô becomes ‚Äò####-03-03‚Äô</p></li>
<li><p>To force last day of month, set ‚Äò99‚Äô: i.e. ‚Äò####-&lt;#-99‚Äô becomes the last day of previous month of refdate</p></li>
</ul>
</dd>
</dl>
</section>
<section id="resource-browse">
<h3>resource_browse<a class="headerlink" href="#resource-browse" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>resource_browse(self, xref, raise_if_not_found=True, resource=None, group=None)</strong></p>
<p>Bind record by xref, searching it or browsing it.
This function returns a record using issued parameters. It works in follow ways:</p>
<ul class="simple">
<li><p>With valid xref it work exactly like self.env.ref()</p></li>
<li><p>If xref is an integer it works exactly like self.browse()</p></li>
<li><dl class="simple">
<dt>I xref is invalid, xref is used to search record</dt><dd><ul>
<li><p>xref is searched in stored data</p></li>
<li><p>xref (‚ÄúMODULE.NAME‚Äù): if MODULE == ‚Äúexternal‚Äù, NAME is the record key</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">xref (str): external reference</div>
<div class="line">raise_if_not_found (bool): raise exception if xref not found or</div>
<div class="line-block">
<div class="line">if more records found</div>
</div>
<div class="line">resource (str): Odoo model name, i.e. ‚Äúres.partner‚Äù</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">obj: the Odoo model record</div>
<div class="line"><br /></div>
</div>
<div class="line">Raises:</div>
<div class="line-block">
<div class="line">ValueError: if invalid parameters issued</div>
</div>
</div>
</section>
<section id="resource-create">
<h3>resource_create<a class="headerlink" href="#resource-create" title="Link to this heading">ÔÉÅ</a></h3>
<p>Create a test record and set external ID to next tests.
This function works as standard Odoo create() with follow improvements:</p>
<ul class="simple">
<li><p>It can create external reference too</p></li>
<li><p>It can use stored data if no values supplied</p></li>
<li><p>Use new api even on Odoo 7.0 or less</p></li>
</ul>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">resource (str): Odoo model name, i.e. ‚Äúres.partner‚Äù</div>
<div class="line">values (dict): record data (default stored data)</div>
<div class="line">xref (str): external reference to create</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">obj: the Odoo model record, if created</div>
</div>
</div>
</section>
<section id="resource-write">
<h3>resource_write<a class="headerlink" href="#resource-write" title="Link to this heading">ÔÉÅ</a></h3>
<p>Update a test record.
This function works as standard Odoo write() with follow improvements:</p>
<ul class="simple">
<li><p>If resource is a record, xref is ignored (it should be None)</p></li>
<li><p>It resource is a string, xref must be a valid xref or an integer</p></li>
<li><p>If values is not supplied, record is restored to stored data values</p></li>
</ul>
<p>def resource_write(self, resource, xref=None, values=None, raise_if_not_found=True, group=None):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>resource (str|obj): Odoo model name or record to update
xref (str): external reference to update: required id resource is string
values (dict): record data (default stored data)
raise_if_not_found (bool): raise exception if xref not found or if more records found
group (str): used to manager group data; default is ‚Äúbase‚Äù</p>
</dd>
<dt>Returns:</dt><dd><p>obj: the Odoo model record</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if invalid parameters issued</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="resource-make">
<h3>resource_make<a class="headerlink" href="#resource-make" title="Link to this heading">ÔÉÅ</a></h3>
<p>Create or write a test record.
This function is a hook to resource_write() or resource_create().</p>
<p>def resource_make(self, resource, xref, values=None, group=None):</p>
</section>
<section id="declare-resource-data">
<h3>declare_resource_data<a class="headerlink" href="#declare-resource-data" title="Link to this heading">ÔÉÅ</a></h3>
<p>Declare data to load on setup_env().</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">resource (str): Odoo model name, i.e. ‚Äúres.partner‚Äù</div>
<div class="line">data (dict): record data</div>
<div class="line">name (str): label of dataset; default is resource name</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line">merge (str): values are (‚Äúlocal‚Äù|‚Äùzerobug‚Äù)</div>
<div class="line"><br /></div>
</div>
<div class="line">Raises:</div>
<div class="line-block">
<div class="line">TypeError: if invalid parameters issued</div>
</div>
</div>
</section>
<section id="declare-all-data">
<h3>declare_all_data<a class="headerlink" href="#declare-all-data" title="Link to this heading">ÔÉÅ</a></h3>
<p>Declare all data to load on setup_env()</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">message (dict): data message</div>
<div class="line-block">
<div class="line">TEST_SETUP_LIST (list): resource list to load</div>
<div class="line">TEST_* (dict): resource data; * is the uppercase resource name where</div>
<div class="line-block">
<div class="line">dot are replaced by ‚Äú_‚Äù; (see declare_resource_data)</div>
</div>
</div>
<div class="line">group (str): used to manager group data; default is ‚Äúbase‚Äù</div>
<div class="line">merge (str): values are (‚Äúlocal‚Äù|‚Äùzerobug‚Äù)</div>
<div class="line">data_dir (str): data directory, default is ‚Äútests/data‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Raises:</div>
<div class="line-block">
<div class="line">TypeError: if invalid parameters issued</div>
</div>
</div>
</section>
<section id="get-resource-data">
<h3>get_resource_data<a class="headerlink" href="#get-resource-data" title="Link to this heading">ÔÉÅ</a></h3>
<p>Get declared resource data; may be used to test compare</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">resource (str): Odoo model name or name assigned, i.e. ‚Äúres.partner‚Äù</div>
<div class="line">xref (str): external reference</div>
<div class="line">group (str): if supplied select specific group data; default is ‚Äúbase‚Äù</div>
<div class="line">try_again (bool): engage conveyed value</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">dictionary with data or empty dictionary</div>
</div>
</div>
</section>
<section id="get-resource-data-list">
<h3>get_resource_data_list<a class="headerlink" href="#get-resource-data-list" title="Link to this heading">ÔÉÅ</a></h3>
<p>Get declared resource data list.</p>
<p>def get_resource_data_list(self, resource, group=None):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>resource (str): Odoo model name or name assigned, i.e. ‚Äúres.partner‚Äù
group (str): if supplied select specific group data; default is ‚Äúbase‚Äù</p>
</dd>
<dt>Returns:</dt><dd><p>list of data</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="get-resource-list">
<h3>get_resource_list<a class="headerlink" href="#get-resource-list" title="Link to this heading">ÔÉÅ</a></h3>
<p>Get declared resource list.</p>
<p>def get_resource_list(self, group=None):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>group (str): if supplied select specific group data; default is ‚Äúbase‚Äù</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="setup-company">
<h3>setup_company<a class="headerlink" href="#setup-company" title="Link to this heading">ÔÉÅ</a></h3>
<p>Setup company values for current user.</p>
<p>This function assigns company to current user and / or can create xref aliases
and /or can update company values.
This function is useful in multi companies tests where different company values
will be used in different tests. May be used in more simple test where company
data will be updated in different tests.
You can assign partner_xref to company base by group; then all tests executed
after setup_env(), use the assigned partner data for company of the group.
You can also create more companies and assign one of them to test by group.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">company (obj): company to update; if not supplied a new company is created</div>
<div class="line">xref (str): external reference or alias for main company</div>
<div class="line">partner_xref (str): external reference or alias for main company partner</div>
<div class="line">recv_xref (str): external reference or alias for receivable account</div>
<div class="line">pay_xref (str): external reference or alias for payable account</div>
<div class="line">bnk1_xref (str): external reference or alias for 1st liquidity bank</div>
<div class="line">values (dict): company data to update immediately</div>
<div class="line">group (str): if supplied select specific group data; default is ‚Äúbase‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">default company for user</div>
</div>
</div>
</section>
<section id="setup-env">
<h3>setup_env<a class="headerlink" href="#setup-env" title="Link to this heading">ÔÉÅ</a></h3>
<p>Create all record from declared data.</p>
<p>This function starts the test workflow creating the test environment.
Test data must be declared before engage this function by file .csv or
file .xlsx or by source declaration TEST_&lt;MODEL&gt;.</p>
<p>setup_env may be called more times with different group value.
If it is called with the same group, it recreates the test environment with
declared values; however this feature might do not work for some reason: i.e.
if test creates a paid invoice, the setup_env() cannot unlink invoice.
If you want to recreate the same test environment, assure the conditions for
unlink of all created and tested records.</p>
<p>If you create more test environment with different group you can grow the data
during test execution with complex scenario.
In this way you can create functional tests not only regression tests.</p>
<div class="line-block">
<div class="line">Args:</div>
<div class="line-block">
<div class="line">lang (str): install &amp; load specific language</div>
<div class="line">locale (str): install locale module with CoA; i.e l10n_it</div>
<div class="line">group (str): if supplied select specific group data; default is ‚Äúbase‚Äù</div>
<div class="line">source (str): values are (‚Äúlocal‚Äù|‚Äùzerobug‚Äù)</div>
<div class="line">setup_list (list): list of Odoo modelS; if missed use TEST_SETUP_LIST</div>
<div class="line">data_dir (str): data directory, default is ‚Äútests/data‚Äù</div>
<div class="line"><br /></div>
</div>
<div class="line">Returns:</div>
<div class="line-block">
<div class="line">None</div>
</div>
</div>
</section>
<section id="resource-edit">
<h3>resource_edit<a class="headerlink" href="#resource-edit" title="Link to this heading">ÔÉÅ</a></h3>
<p>Server-side web form editing.</p>
<p>Ordinary Odoo test use the primitive create() and write() function to manage
test data. These methods create an update records, but they do not properly
reflect the behaviour of user editing form with GUI interface.</p>
<p>This function simulates the client-side form editing in the server-side.
It works in the follow way:</p>
<ul class="simple">
<li><p>It can simulate the form create record</p></li>
<li><p>It can simulate the form update record</p></li>
<li><p>It can simulate the user data input</p></li>
<li><p>It calls the onchange functions automatically</p></li>
<li><p>It may be used to call button in the form</p></li>
</ul>
<p>User action simulation:</p>
<p>The parameter &lt;web_changes&gt; is a list of user actions to execute sequentially.
Every element of the list is another list with 2 or 3 values:</p>
<ul class="simple">
<li><p>Field name to assign value</p></li>
<li><p>Value to assign</p></li>
<li><p>Optional function to execute (i.e. specific onchange)</p></li>
</ul>
<p>If field is associated to an onchange function the relative onchange functions
are execute after value assignment. If onchange set another field with another
onchange the relative another onchange are executed until all onchange are
exhausted. This behavior is the same of the form editing.</p>
<p>Warning: because function are always executed at the server side the behavior
may be slightly different from actual form editing. Please take note of
following limitations:</p>
<ul class="simple">
<li><p>update form cannot simulate discard button</p></li>
<li><p>some required data in create must be supplied by default parameter</p></li>
<li><p>form inconsistency cannot be detected by this function</p></li>
<li><p>nested function must be managed by test code (i.e. wizard from form)</p></li>
</ul>
<p>See test_testenv module for test examples
<a class="reference external" href="https://github.com/zeroincombenze/zerobug-test/tree/12.0/test_testenv">https://github.com/zeroincombenze/zerobug-test/tree/12.0/test_testenv</a></p>
<p>def resource_edit(self, resource, default={}, web_changes=[], actions=[], ctx={}):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>resource (str or obj): if field is a string simulate create web behavior of
Odoo model issued in resource;
if field is an obj simulate write web behavior on the issued record
default (dict): default value to assign
web_changes (list): list of tuples (field, value); see &lt;wiz_edit&gt;</p>
</dd>
<dt>Returns:</dt><dd><p>windows action to execute or obj record</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="wizard">
<h3>wizard<a class="headerlink" href="#wizard" title="Link to this heading">ÔÉÅ</a></h3>
<p>Execute a full wizard.</p>
<p>Engage the specific wizard, simulate user actions and return the wizard result,
usually a windows action.</p>
<p>It is useful to test:</p>
<blockquote>
<div><ul class="simple">
<li><p>view names</p></li>
<li><p>wizard structure</p></li>
<li><p>wizard code</p></li>
</ul>
</div></blockquote>
<p>Both parameters &lt;module&gt; and &lt;action_name&gt; must be issued in order to
call &lt;wiz_by_action_name&gt;; they are alternative to act_windows.</p>
<p><strong>* Example of use *</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XML</span> <span class="n">view</span> <span class="n">file</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">record</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;action_example&quot;</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ir.actions.act_window&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">field</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;</span><span class="n">Example</span><span class="o">&lt;/</span><span class="n">field</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">field</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;res_model&quot;</span><span class="o">&gt;</span><span class="n">wizard</span><span class="o">.</span><span class="n">example</span><span class="o">&lt;/</span><span class="n">field</span><span class="o">&gt;</span>
        <span class="p">[</span><span class="o">...</span><span class="p">]</span>
    <span class="o">&lt;/</span><span class="n">record</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Python code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">act_windows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wizard</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="s2">&quot;module_example&quot;</span><span class="p">,</span>
    <span class="n">action_name</span><span class="o">=</span><span class="s2">&quot;action_example&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_action</span><span class="p">(</span><span class="n">act_windows</span><span class="p">):</span>
    <span class="n">act_windows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wizard</span><span class="p">(</span><span class="n">act_windows</span><span class="o">=</span><span class="n">act_windows</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>User action simulation:</p>
<p>The parameter &lt;web_changes&gt; is a list of user actions to execute sequentially.
Every element of the list is another list with 2 or 3 values:</p>
<ul class="simple">
<li><p>Field name to assign value</p></li>
<li><p>Value to assign</p></li>
<li><p>Optional function to execute (i.e. specific onchange)</p></li>
</ul>
<p>If field is associated to an onchange function the relative onchange functions
are execute after value assignment. If onchange set another field with another
onchange the relative another onchange are executed until all onchange are
exhausted. This behavior is the same of the form editing.</p>
<p>def wizard(self, module=None, action_name=None, act_windows=None, records=None, default=None, ctx={}, button_name=None, web_changes=[], button_ctx={},):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>module (str): module name for wizard to test; if ‚Äú.‚Äù use current module name
action_name (str): action name
act_windows (dict): Odoo windows action (do not issue module &amp; action_name)
records (obj): objects required by the download wizard
default (dict): default value to assign
ctx (dict): context to pass to wizard during execution
button_name (str): function name to execute at the end of then wizard
web_changes (list): list of tuples (field, value); see above
button_ctx (dict): context to pass to button_name function</p>
</dd>
<dt>Returns:</dt><dd><p>result of the wizard</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if invalid parameters issued</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="validate-record">
<h3>validate_record<a class="headerlink" href="#validate-record" title="Link to this heading">ÔÉÅ</a></h3>
<p>Validate records against template values.
During the test will be necessary to check result record values.
This function aim to validate all the important values with one step.
You have to issue 2 params: template with expected values and record to check.
You can declare just some field value in template which are important for you.
Both template and record are lists, record may be a record set too.
This function do following steps:</p>
<ul class="simple">
<li><p>matches templates and record, based on template supplied data</p></li>
<li><p>check if all template are matched with 1 record to validate</p></li>
<li><p>execute self.assertEqual() for every field in template</p></li>
<li><p>check for every template record has matched with assert</p></li>
</ul>
<p>def validate_records(self, template, records):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>template (list of dict): list of dictionaries with expected values
records (list or set): records to validate values</p>
</dd>
<dt>Returns:</dt><dd><p>list of matched coupled (template, record) + # of assertions</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if no enough assertions or one assertion is failed</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="get-records-from-act-windows">
<h3>get_records_from_act_windows<a class="headerlink" href="#get-records-from-act-windows" title="Link to this heading">ÔÉÅ</a></h3>
<p>Get records from a windows message.</p>
<p>def get_records_from_act_windows(self, act_windows):</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>act_windows (dict): Odoo windows action returned by a wizard</p>
</dd>
<dt>Returns:</dt><dd><p>records or False</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: if invalid parameters issued</p>
</dd>
</dl>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logozero_180x46.png" alt="Logo of z0bug_odoo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Usage</a><ul>
<li><a class="reference internal" href="#usage-details">Usage Details</a><ul>
<li><a class="reference internal" href="#model-data-declaration">Model data declaration</a></li>
<li><a class="reference internal" href="#magic-relationship">Magic relationship</a></li>
<li><a class="reference internal" href="#external-reference">External reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-test-execution-session">Module test execution session</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-values">Data values</a><ul>
<li><a class="reference internal" href="#company-id">company_id</a></li>
<li><a class="reference internal" href="#boolean">boolean</a></li>
<li><a class="reference internal" href="#char-text">char / text</a></li>
<li><a class="reference internal" href="#integer-float-monetary">integer / float / monetary</a></li>
<li><a class="reference internal" href="#date-datetime">date / datetime</a></li>
<li><a class="reference internal" href="#many2one">many2one</a></li>
<li><a class="reference internal" href="#one2many-many2many">one2many / many2many</a></li>
<li><a class="reference internal" href="#binary">binary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#useful-external-reference">Useful External Reference</a></li>
<li><a class="reference internal" href="#functions">Functions</a><ul>
<li><a class="reference internal" href="#cast-types">cast_types</a></li>
<li><a class="reference internal" href="#store-resource-data">store_resource_data</a></li>
<li><a class="reference internal" href="#compute-date">compute_date</a></li>
<li><a class="reference internal" href="#resource-browse">resource_browse</a></li>
<li><a class="reference internal" href="#resource-create">resource_create</a></li>
<li><a class="reference internal" href="#resource-write">resource_write</a></li>
<li><a class="reference internal" href="#resource-make">resource_make</a></li>
<li><a class="reference internal" href="#declare-resource-data">declare_resource_data</a></li>
<li><a class="reference internal" href="#declare-all-data">declare_all_data</a></li>
<li><a class="reference internal" href="#get-resource-data">get_resource_data</a></li>
<li><a class="reference internal" href="#get-resource-data-list">get_resource_data_list</a></li>
<li><a class="reference internal" href="#get-resource-list">get_resource_list</a></li>
<li><a class="reference internal" href="#setup-company">setup_company</a></li>
<li><a class="reference internal" href="#setup-env">setup_env</a></li>
<li><a class="reference internal" href="#resource-edit">resource_edit</a></li>
<li><a class="reference internal" href="#wizard">wizard</a></li>
<li><a class="reference internal" href="#validate-record">validate_record</a></li>
<li><a class="reference internal" href="#get-records-from-act-windows">get_records_from_act_windows</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="rtd_features.html"
                          title="previous chapter">Features</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="rtd_getting_started.html"
                          title="next chapter">Getting started</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/rtd_usage.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rtd_getting_started.html" title="Getting started"
             >next</a> |</li>
        <li class="right" >
          <a href="rtd_features.html" title="Features"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">z0bug_odoo 2.0.22 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Usage</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2019-24, SHS-AV s.r.l..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>